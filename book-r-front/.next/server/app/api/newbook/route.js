"use strict";(()=>{var e={};e.id=8537,e.ids=[8537],e.modules={38013:e=>{e.exports=require("mongodb")},11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},72254:e=>{e.exports=require("node:buffer")},6005:e=>{e.exports=require("node:crypto")},47261:e=>{e.exports=require("node:util")},16086:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>v,patchFetch:()=>h,requestAsyncStorage:()=>x,routeModule:()=>f,serverHooks:()=>m,staticGenerationAsyncStorage:()=>y});var n={};t.r(n),t.d(n,{DELETE:()=>w,GET:()=>d,POST:()=>l,PUT:()=>g});var s=t(49303),o=t(88716),a=t(60670),i=t(87070),u=t(55285),p=t(16368),c=t(44830);async function d(e){try{let r=await (0,c.I8)(),t=r?.user?.id;if(!t||!["6681baf3edaf2e8a771432a2"].includes(t))return i.NextResponse.json({message:"You are not authorized to view this page"});await (0,u.Z)();let{searchParams:n}=new URL(e.url),s=n.get("id");if(s){let e=await p.Z.findById(s);if(!e)return i.NextResponse.json({message:"Book not found"},{status:404});return i.NextResponse.json(e)}let o=await p.Z.find();return i.NextResponse.json(o)}catch(e){return console.error("GET request error:",e),new Response("Internal Server Error",{status:500})}}async function l(e){try{let r=await (0,c.I8)(),t=r?.user?.id;if(!t||!["6681baf3edaf2e8a771432a2"].includes(t))return i.NextResponse.json({message:"You are not authorized to view this page"});await (0,u.Z)();let{title:n,author:s,year:o,description:a,link:d,images:l,sorting:g,properties:w,cGenre:f}=await e.json(),x=await p.Z.create({title:n,author:s,year:o,description:a,link:d,images:l,sorting:g,properties:w,genre:f});return console.log("Book created successfully:",x),i.NextResponse.json({bookDocument:x})}catch(e){return console.error("POST request error:",e),new Response("Internal Server Error",{status:500})}}async function g(e){try{let r=await (0,c.I8)(),t=r?.user?.id;if(!t||!["6681baf3edaf2e8a771432a2"].includes(t))return i.NextResponse.json({message:"You are not authorized to view this page"});let{title:n,author:s,year:o,description:a,link:d,_id:l,images:g,sorting:w,properties:f,cGenre:x}=await e.json();return await (0,u.Z)(),await p.Z.updateOne({_id:l},{title:n,author:s,year:o,description:a,link:d,images:g,sorting:w,properties:f,genre:x}),i.NextResponse.json({message:"Book updated successfully"})}catch(e){return console.error("PUT request error:",e),new Response("Internal Server Error",{status:500})}}async function w(e){try{let r=await (0,c.I8)(),t=r?.user?.id;if(!t||!["6681baf3edaf2e8a771432a2"].includes(t))return i.NextResponse.json({message:"You are not authorized to view this page"});await (0,u.Z)();let{id:n}=await e.json();return await p.Z.deleteOne({_id:n}),i.NextResponse.json({message:"Book deleted successfully"})}catch(e){return console.error("DELETE request error:",e),new Response("Internal Server Error",{status:500})}}let f=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/newbook/route",pathname:"/api/newbook",filename:"route",bundlePath:"app/api/newbook/route"},resolvedPagePath:"/Users/shashanklahoti/Desktop/Coding Projects/test2-Front/book-r-front/app/api/newbook/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:x,staticGenerationAsyncStorage:y,serverHooks:m}=f,v="/api/newbook/route";function h(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:y})}},44830:(e,r,t)=>{let n;t.d(r,{I8:()=>f,handlers:()=>l});var s=t(15138),o=t(8204),a=t(80092),i=t(64704),u=t(38013);if(!process.env.MONGODB_URI)throw Error('Invalid/Missing environment variable: "MONGODB_URI"');let p=process.env.MONGODB_URI,c={serverApi:{version:u.ServerApiVersion.v1,strict:!0,deprecationErrors:!0}};n=new u.MongoClient(p,c).connect();let d=["6681baf3edaf2e8a771432a2"],{handlers:l,signIn:g,signOut:w,auth:f}=(0,s.ZP)({providers:[o.Z,a.Z],adapter:(0,i.dJ)(n),pages:{signIn:"/auth/login",signOut:"/auth/logout"},callbacks:{jwt:async({token:e,account:r})=>(r&&(e.accessToken=r.access_token),e),session:async({session:e,token:r,user:t})=>d.includes(e?.user?.id)?{...e,isAdmin:!0}:{...e,isAdmin:!1}}})},55285:(e,r,t)=>{t.d(r,{Z:()=>o});var n=t(11185),s=t.n(n);function o(){if(1===s().connection.readyState)return s().connection.asPromise();{let e=process.env.MONGODB_URI;return s().connect(e)}}},16368:(e,r,t)=>{t.d(r,{Z:()=>a});var n=t(11185),s=t.n(n);let o=new n.Schema({title:{type:String,required:!0},author:{type:String,required:!0},year:{type:Number,required:!0},description:{type:String,required:!0},link:{type:String,required:!0},images:{type:[{type:String}]},sorting:{type:s().Types.ObjectId,ref:"Sorting"},properties:{type:Object},genre:{type:String}}),a=s().models.NewBook||s().model("NewBook",o)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[8948,5972,9066],()=>t(16086));module.exports=n})();
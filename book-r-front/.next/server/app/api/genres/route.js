"use strict";(()=>{var e={};e.id=4808,e.ids=[4808],e.modules={38013:e=>{e.exports=require("mongodb")},11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},72254:e=>{e.exports=require("node:buffer")},6005:e=>{e.exports=require("node:crypto")},47261:e=>{e.exports=require("node:util")},8300:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>w,patchFetch:()=>q,requestAsyncStorage:()=>m,routeModule:()=>v,serverHooks:()=>y,staticGenerationAsyncStorage:()=>h});var n={};t.r(n),t.d(n,{DELETE:()=>x,GET:()=>g,POST:()=>f});var s=t(49303),o=t(88716),a=t(60670),i=t(55285),u=t(11185);let c=new u.Schema({name:{type:String,required:!0},parent:{type:String},books:[{type:Object}]}),p=u.models?.Genre||(0,u.model)("Genre",c);var d=t(44830),l=t(87070);async function g(e){let r=await (0,d.I8)(),t=r?.user?.id;if("string"!=typeof t||!["6681baf3edaf2e8a771432a2"].includes(t))return l.NextResponse.json({message:"You are not authorized to view this page"});await (0,i.Z)();try{let e=await p.find();return l.NextResponse.json(e)}catch(e){return console.error("GET request error:",e),new Response("Internal Server Error",{status:500})}}async function f(e){let r=await (0,d.I8)(),t=r?.user?.id;if("string"!=typeof t||!["6681baf3edaf2e8a771432a2"].includes(t))return l.NextResponse.json({message:"You are not authorized to view this page"});try{await (0,i.Z)();let{name:r,parent:t}=await e.json(),n=await p.create({name:r,parent:t});return console.log("Genre created successfully:",n),l.NextResponse.json({genreDocument:n})}catch(e){return console.error("POST request error:",e),new Response("Internal Server Error",{status:500})}}async function x(e){let r=await (0,d.I8)(),t=r?.user?.id;if("string"!=typeof t||!["6681baf3edaf2e8a771432a2"].includes(t))return l.NextResponse.json({message:"You are not authorized to view this page"});try{await (0,i.Z)();let{id:r}=await e.json();return await p.deleteOne({_id:r}),l.NextResponse.json({message:"Genre deleted successfully"})}catch(e){return console.error("DELETE request error:",e),new Response("Internal Server Error",{status:500})}}let v=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/genres/route",pathname:"/api/genres",filename:"route",bundlePath:"app/api/genres/route"},resolvedPagePath:"/Users/shashanklahoti/Desktop/Coding Projects/test2-Front/book-r-front/app/api/genres/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:h,serverHooks:y}=v,w="/api/genres/route";function q(){return(0,a.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:h})}},44830:(e,r,t)=>{let n;t.d(r,{I8:()=>x,handlers:()=>l});var s=t(15138),o=t(8204),a=t(80092),i=t(64704),u=t(38013);if(!process.env.MONGODB_URI)throw Error('Invalid/Missing environment variable: "MONGODB_URI"');let c=process.env.MONGODB_URI,p={serverApi:{version:u.ServerApiVersion.v1,strict:!0,deprecationErrors:!0}};n=new u.MongoClient(c,p).connect();let d=["6681baf3edaf2e8a771432a2"],{handlers:l,signIn:g,signOut:f,auth:x}=(0,s.ZP)({providers:[o.Z,a.Z],adapter:(0,i.dJ)(n),pages:{signIn:"/auth/login",signOut:"/auth/logout"},callbacks:{jwt:async({token:e,account:r})=>(r&&(e.accessToken=r.access_token),e),session:async({session:e,token:r,user:t})=>d.includes(e?.user?.id)?{...e,isAdmin:!0}:{...e,isAdmin:!1}}})},55285:(e,r,t)=>{t.d(r,{Z:()=>o});var n=t(11185),s=t.n(n);function o(){if(1===s().connection.readyState)return s().connection.asPromise();{let e=process.env.MONGODB_URI;return s().connect(e)}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[8948,5972,9066],()=>t(8300));module.exports=n})();